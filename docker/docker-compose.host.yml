services:
  anki:
    platform: linux/amd64
    image: ghcr.io/adanato/arete/anki-custom:latest
    container_name: anki-test
    environment:
      - PUID=1000
      - PGID=1000
      - ANKI_LANG=en
      - ANKI_VERSION=24.11
      - QT_QUICK_BACKEND=software
      - ANKI_NOHIGHDPI=1
      - ANKICONNECT_BIND_ADDRESS=0.0.0.0
    # Host mode networking: Shares network namespace with host.
    # No port mapping needed. 127.0.0.1 in container is 127.0.0.1 on host.
    network_mode: "host" 
    volumes:
      - ./anki_data:/config
      - ../arete_ankiconnect:/config/.local/share/Anki2/addons21/arete_ankiconnect
    shm_size: "1gb"
    restart: unless-stopped
